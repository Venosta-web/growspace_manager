name: "Code Quality Check"

on: [push, pull_request]

jobs:
  quality-checks:
    runs-on: ubuntu-latest

    strategy:
      matrix:
        # Use the Python versions that are relevant for HA (e.g. 3.12)
        # 3.13 is still very new, 3.12 is a more stable choice for CI.
        python-version: ["3.12"]

    steps:
      - name: "Checkout code"
        uses: actions/checkout@v4

      - name: "Set up Python ${{ matrix.python-version }}"
        uses: actions/setup-python@v5
        with:
          python-version: ${{ matrix.python-version }}

      - name: "Install dependencies"
        run: |
          python -m pip install --upgrade pip
          # Install the linting tools
          pip install ruff pylint mypy

          # Install your project's dependencies,
          # so that Pylint/MyPy can find them
          # (Based on your test files)
          pip install voluptuous freezegun python-dateutil

      - name: "1. Check Formatting (Ruff)"
        run: |
          ruff format custom_components/growspace_manager --check

      - name: "2. Check Linting (Ruff)"
        run: |
          ruff check custom_components/growspace_manager

      - name: "3. Check Linting (Pylint)"
        run: |
          pylint custom_components/growspace_manager

      - name: "4. Check Type Hints (MyPy)"
        run: |
          # --ignore-missing-imports is often required for HA components
          mypy custom_components/growspace_manager --ignore-missing-imports
