name: "Code Quality Check"

on: [push, pull_request]

jobs:
  quality-checks:
    runs-on: ubuntu-latest

    strategy:
      matrix:
        # Verwende die Python-Versionen, die für HA relevant sind (z.B. 3.12)
        # 3.13 ist noch sehr neu, 3.12 ist eine stabilere Wahl für CI.
        python-version: ["3.12"]

    steps:
      - name: "Checkout code"
        uses: actions/checkout@v4

      - name: "Set up Python ${{ matrix.python-version }}"
        uses: actions/setup-python@v5
        with:
          python-version: ${{ matrix.python-version }}

      - name: "Install dependencies"
        run: |
          python -m pip install --upgrade pip
          # Installiere die Linting-Tools
          pip install ruff pylint mypy

          # Installiere die Abhängigkeiten deines Projekts,
          # damit Pylint/MyPy sie finden können
          # (Basierend auf deinen Test-Dateien)
          pip install voluptuous freezegun python-dateutil

      - name: "1. Check Formatting (Ruff)"
        run: |
          ruff format custom_components/growspace_manager --check

      - name: "2. Check Linting (Ruff)"
        run: |
          ruff check custom_components/growspace_manager

      - name: "3. Check Linting (Pylint)"
        run: |
          pylint custom_components/growspace_manager

      - name: "4. Check Type Hints (MyPy)"
        run: |
          # --ignore-missing-imports wird oft für HA-Komponenten benötigt
          mypy custom_components/growspace_manager --ignore-missing-imports
